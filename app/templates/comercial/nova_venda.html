{% extends 'base.html' %}
{% block content %}
<div class="container mt-3">
  <h3>Nova Venda</h3>
  <form method="post" class="card card-body">
    {{ form.hidden_tag() }}
    <div class="row g-3">
      <div class="col-md-4">{{ form.representante.label(class="form-label") }}{{ form.representante(class="form-control") }}</div>
      <div class="col-md-2">{{ form.estado.label(class="form-label") }}{{ form.estado(class="form-select", id="uf") }}</div>
      <div class="col-md-3">{{ form.municipio.label(class="form-label") }}{{ form.municipio(class="form-control") }}</div>
      <div class="col-md-3">{{ form.regiao.label(class="form-label") }}{{ form.regiao(class="form-select", id="regiao") }}</div>

      <div class="col-md-6">{{ form.cliente.label(class="form-label") }}{{ form.cliente(class="form-control") }}</div>
      <div class="col-md-3">{{ form.pedido.label(class="form-label") }}{{ form.pedido(class="form-control") }}</div>
      <div class="col-md-3">{{ form.data_inclusao.label(class="form-label") }}{{ form.data_inclusao(class="form-control", type="date") }}</div>

      <div class="col-md-3">{{ form.quantidade.label(class="form-label") }}{{ form.quantidade(class="form-control") }}</div>
      <div class="col-md-3">{{ form.valor.label(class="form-label") }}{{ form.valor(class="form-control") }}</div>
      <div class="col-md-3">{{ form.produto.label(class="form-label") }}{{ form.produto(class="form-control") }}</div>
      <div class="col-md-3">{{ form.grupo.label(class="form-label") }}{{ form.grupo(class="form-control") }}</div>
    </div>
    <div class="mt-3">
      <button class="btn btn-primary">{{ form.submit.label.text }}</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('routes.listar_vendas') }}">Cancelar</a>
    </div>
  </form>
</div>

<script>
const UF2REGIAO = {
  AC:"NORTE",AP:"NORTE",AM:"NORTE",PA:"NORTE",RO:"NORTE",RR:"NORTE",TO:"NORTE",
  AL:"NORDESTE",BA:"NORDESTE",CE:"NORDESTE",MA:"NORDESTE",PB:"NORDESTE",
  PE:"NORDESTE",PI:"NORDESTE",RN:"NORDESTE",SE:"NORDESTE",
  DF:"CENTRO-OESTE",GO:"CENTRO-OESTE",MT:"CENTRO-OESTE",MS:"CENTRO-OESTE",
  ES:"SUDESTE",MG:"SUDESTE",RJ:"SUDESTE",SP:"SUDESTE",
  PR:"SUL",RS:"SUL",SC:"SUL",
};
const uf  = document.getElementById('uf');
const reg = document.getElementById('regiao');

// Sempre que mudar UF, atualiza a região correspondente
if (uf && reg) {
  const sync = ()=> { reg.value = UF2REGIAO[uf.value] || ""; };
  uf.addEventListener('change', sync);
  // opcional: sincroniza já na carga (útil em editar)
  sync();
}
</script>

{% endblock %}
